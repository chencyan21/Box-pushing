# Gemini AI Agent 使用说明

## 如何获取 Gemini API Key

### 1. 访问 Google AI Studio
前往 [Google AI Studio](https://aistudio.google.com/)

### 2. 登录 Google 账户
使用您的 Google 账户登录

### 3. 获取 API Key
1. 点击左侧菜单中的 "Get API key"
2. 点击 "Create API key"
3. 选择或创建一个 Google Cloud 项目
4. 复制生成的 API Key

### 4. 启用必要的服务
确保在 Google Cloud Console 中启用了 "Generative Language API"

## 游戏中的 AI Agent 功能

### 功能说明
- AI Agent 使用 Gemini-2.5-flash 模型
- 根据当前游戏状态自动计算最佳跳跃力度
- 考虑物理参数和抛物线运动轨迹

### 输入参数详解
AI Agent 会自动获取以下游戏状态并进行分析：

**坐标系统**
- 玩家位置: (px, py)
  - X坐标：水平位置，数值越大越靠右
  - Y坐标：垂直位置，数值越大越靠下（屏幕坐标系）

- 目标平台位置(L, T, R): (plat_left, plat_top, plat_right)
  - L (左边界)：平台的最左侧X坐标
  - T (顶部)：平台的最上方Y坐标（着陆目标高度）
  - R (右边界)：平台的最右侧X坐标

**物理运动参数**
- 横向速度倍率 (vx_multiplier = 0.10)
  - 含义：跳跃力度转换为水平速度的系数
  - 计算：水平初始速度 = 跳跃力度 × 0.10
  - 影响：数值越大，相同力度下水平飞行距离越远

- 纵向速度倍率 (vy_multiplier = -0.25)
  - 含义：跳跃力度转换为垂直速度的系数
  - 计算：垂直初始速度 = 跳跃力度 × (-0.25)
  - 特点：负值表示向上运动（与屏幕坐标系相反）
  - 影响：绝对值越大，相同力度下跳跃高度越高

- 重力加速度 (gravity = 0.75)
  - 含义：每个时间步长内，垂直速度的增量
  - 作用：使玩家在空中时持续向下加速
  - 影响：数值越大，抛物线弧度越陡峭

**物理运动方程**
每个时间步长内的运动更新：
1. 水平位置：x = x + vx（匀速运动）
2. 垂直位置：y = y + vy
3. 垂直速度：vy = vy + gravity（重力加速）

### 输出结果
- 推荐的跳跃力度 (0-100 的整数)

## 使用步骤

### 1. 输入 API Key
在游戏界面的 "Gemini API Key" 输入框中粘贴您的 API Key

### 2. 启用 AI 功能
输入 API Key 后，"🤖 AI自动跳跃" 按钮会自动启用

### 3. 使用 AI 跳跃
1. 点击 "🤖 AI自动跳跃" 按钮
2. AI 会分析当前游戏状态
3. 计算出推荐的跳跃力度
4. 自动执行跳跃

### 4. 观察结果
- AI 状态会显示计算进度
- 推荐力度会显示在状态面板中
- 游戏会自动执行跳跃动作

## 注意事项

### API 使用限制
- 免费额度有限，请合理使用
- 网络连接需要稳定
- API Key 请妥善保管，不要泄露

### 性能说明
- AI 计算需要 1-3 秒时间
- 建议在网络良好的环境下使用
- 首次使用可能需要更长时间

### 故障排除
如果 AI 功能不工作，请检查：
1. API Key 是否正确
2. 网络连接是否正常
3. Google Cloud 项目是否启用了相关服务
4. 是否超出了 API 使用限额

## 技术实现细节

### API 调用
- 使用 Google Generative Language API
- 模型：gemini-2.5-flash
- 温度设置：0.1（确保结果稳定）
- 最大输出令牌：50

### 物理计算提示
AI 会根据以下物理公式进行计算：
- 水平速度 = 跳跃力度 × 0.15
- 垂直速度 = 跳跃力度 × (-0.25)
- 重力加速度 = 0.5

### 安全性
- API Key 仅在本地存储，不会上传到服务器
- 所有 API 调用都是直接与 Google 服务器通信
- 建议定期更换 API Key
